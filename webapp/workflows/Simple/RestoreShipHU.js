/*
 * Copyright (C) 2009-2023 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["scm/ewm/packoutbdlvs1/workflows/WorkFlow","scm/ewm/packoutbdlvs1/service/ODataService","scm/ewm/packoutbdlvs1/modelHelper/Global","scm/ewm/packoutbdlvs1/utils/Util","scm/ewm/packoutbdlvs1/utils/Const","scm/ewm/packoutbdlvs1/modelHelper/Message"],function(W,S,G,U,C,M){"use strict";return function(s,o){var w=new W().then(function(p,m){return S.getOpenShippingHU();},o).then(function(p,m){this.setBusy(false);m.aShipHUs=p;if(p.length>1){var a=this.getI18nText("moreThanOneShipHUMsg");this.showErrorMessageBox(a);throw new Error();}else{G.addShipHandlingUnit(p[0].HuId);this.restoreShipHUTabs(p);return p;}},o).then(function(p,m){p.forEach(function(a){this.clearActualWeight(a.HuId);}.bind(this));},o).then(function(p,m){this.oItemHelper.setItems(m.aShipHUs[m.aShipHUs.length-1].Items.results);},o);w.errors().subscribe(C.ERRORS.CREATE_HU_DUPLICATE,function(e){M.addError(e);}).subscribe(C.ERRORS.SHIP_HU_CREATED_INTERNALLY,function(e){M.addError(e);}).subscribe(C.ERRORS.INTERVAL_HU_ID_NOT_DEFINED,function(){var e=this.getI18nText("createShipHUContactAdmin");this.showErrorMessageBox(e);},o).always(function(){G.setBusy(false);this.playAudio(C.ERROR);});return w;};});
