/*
 * Copyright (C) 2009-2023 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["scm/ewm/packoutbdlvs1/workflows/WorkFlow","scm/ewm/packoutbdlvs1/service/ODataService","scm/ewm/packoutbdlvs1/modelHelper/Global","scm/ewm/packoutbdlvs1/utils/Util","scm/ewm/packoutbdlvs1/utils/Const","scm/ewm/packoutbdlvs1/modelHelper/Message","scm/ewm/packoutbdlvs1/modelHelper/Material"],function(W,S,G,U,C,M,a){"use strict";return function(s,o){var w=new W().then(function(c,m){if(c.bOpen){return this.onOpenCreateShipHUDialog();}else{m.oCreateInfo=c;}},o).then(function(p,m){this.prepareParemeterForCreation(m.oCreateInfo,m);},s).then(function(p,m){return S.createShippingHU(m.sHuId,m.sMaterialId);},o).then(function(p,m){m.sHuId=p.HuId;this.updateParameterAfterCreation(p,m);},o).then(function(p,m){return this.createNewTab(m.sHuId,C.TAB.ADVANCED);},o).then(function(p,m){m.oComponent.setBusy(false).close();},o).then(function(p,m){this.updateDataBingdingAfterCreation(m);this.handleButtonsEnableAfterCreate(m);},o).then(function(p,m){this.handleFocusAndHighlightForCreation();},s).then(function(p,P){return this.updateItemWeightInNeed();},s,"check if there exists source item which is not in ItemWeight").then(function(p,m){this.updateNetWeightRelated(0,a.getCurrentMaterialUom());},o,"update net weight related").then(function(p,P){P.sODO="";P.sPackInstr="";if(this.oItemHelper.getHighLightedItemIndex()===0){P.sODO=this.oItemHelper.getItemDocNoByIndex(0);P.sPackInstr=this.oItemHelper.getItemPackInstrByIndex(0);}},s).then(function(p,P){this.updatePackingInstr(P.sODO,P.sPackInstr);},o,"update packing info").then(function(p,P){this.updateCacheIsEmptyHU();},o,"update cache").then(function(p,m){var b=this.getTextAccordingToMode("createHuSuccessMsg","createShipHuSuccessMsg",[m.sHuId]);M.addSuccess(b);this.playAudio(C.INFO);},o);w.errors().subscribe(C.ERRORS.CREATE_HU_DUPLICATE,function(e){this.updateInputWithError(C.ID.CREATE_SHIP_INPUT,e);this.focus(C.ID.CREATE_SHIP_INPUT);},o).subscribe(C.ERRORS.SHIP_HU_CREATED_INTERNALLY,function(e){this.updateInputWithError(C.ID.CREATE_SHIP_INPUT,e);},o).subscribe(C.ERRORS.INTERVAL_HU_ID_NOT_DEFINED,function(e){e=this.getI18nText("createShipHUContactAdmin");this.updateInputWithError(C.ID.CREATE_SHIP_INPUT,e);},o).subscribe(C.ERRORS.HU_ASSIGNED_FAILED,function(e){this.updateInputWithError(C.ID.CREATE_SHIP_INPUT,e);this.focus(C.ID.CREATE_SHIP_INPUT);},o).subscribe(C.ERRORS.HU_PROCESSED_BY_OTHER,function(e){this.updateInputWithError(C.ID.CREATE_SHIP_INPUT,e);this.focus(C.ID.CREATE_SHIP_INPUT);},o).default(function(e){this.getView().byId("createShipHUDialog").close();},o).default(function(e,p,m,c){if(c){this.showErrorMessagePopup(e);}},s).always(function(e,p,m){this.getView().byId("createShipHUDialog").setBusy(false);this.playAudio(C.ERROR);},o);return w;};});
