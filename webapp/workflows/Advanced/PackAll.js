/*
 * Copyright (C) 2009-2023 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["scm/ewm/packoutbdlvs1/workflows/WorkFlow","scm/ewm/packoutbdlvs1/utils/Util","scm/ewm/packoutbdlvs1/utils/Const","scm/ewm/packoutbdlvs1/modelHelper/Message","scm/ewm/packoutbdlvs1/service/ODataService","scm/ewm/packoutbdlvs1/modelHelper/Cache","scm/ewm/packoutbdlvs1/modelHelper/Global"],function(W,U,C,M,S,a,G){"use strict";return function(s,o){var w=new W().then(function(p,P){P.aProducts=p;},s,"set oParams").then(function(){return this.updateItemWeightInNeed();},s,"check if there exists source item which is not in ItemWeight").then(function(p,P){return S.packAll(p);},s).then(function(p,P){P.NetWeight=p.NetWeight;P.WeightUoM=p.WeightUoM;this.oItemHelper.clear();G.setProductId("");this.disableButtons();},s,"remove item from left").then(function(){this.unbindProductInfo();this.unbindImage();},s,"unbind product info").then(function(){this.unbindODOInfo();this.focus(C.ID.PRODUCT_INPUT);},s,"update odo info").then(function(){this.updateInputWithDefault(C.ID.SHIP_INPUT,"");},o,"clear ship input").then(function(p,P){P.bShipHUEmptyBeforePack=this.oItemHelper.isEmpty();return S.getHUItems(G.getCurrentShipHandlingUnit(),C.SHIP_TYPE_HU);},o).then(function(p,P){this.setBusy(false);this.oItemHelper.setItems(p);this.oItemHelper.setItemsStatusToNone();this.oItemHelper.setItemHighlightByIndex(0);this.handleUnpackEnable();},o,"add item in the right table").then(function(p,P){if(P.bShipHUEmptyBeforePack){a.updateShipHUConsGroup(G.getCurrentShipHandlingUnit(),P.aProducts[0].EWMConsolidationGroup);}},o,"if it is the first item in the right, update packing info").then(function(){this.dehilightShipHandlingUnits();},o).then(function(p,P){this.updateNetWeightRelated(P.NetWeight,P.WeightUoM);this.clearGrossWeight();this.clearPackingInstr();},o,"update weight chart, color and text").then(function(p,P){this.updateCacheIsEmptyHU();},o,"update cache").then(function(p,m){this.delayCalledAdjustContainerHeight();},o);w.errors().default(function(e,p,m,c){if(c){this.showErrorMessagePopup(e);}},s).always(function(){this.setBusy(false);this.focus(C.ID.PRODUCT_INPUT);this.playAudio(C.ERROR);},s);return w;};});
