/*
 * Copyright (C) 2009-2023 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["scm/ewm/packoutbdlvs1/workflows/WorkFlow","scm/ewm/packoutbdlvs1/utils/Util","scm/ewm/packoutbdlvs1/utils/Const","scm/ewm/packoutbdlvs1/utils/CustomError","scm/ewm/packoutbdlvs1/modelHelper/Message","scm/ewm/packoutbdlvs1/service/ODataService","scm/ewm/packoutbdlvs1/modelHelper/Global","scm/ewm/packoutbdlvs1/modelHelper/Cache"],function(W,U,C,a,M,S,G,b){"use strict";return function(s,o){var w=new W().then(function(p,P){P.aProducts=p;return S.unpackAll(p);},o,"call backend service to unpack all items").then(o.unpackCallback,o,"delete the ship hu from ui and interupt the following actions, if it is deleted from backend").then(function(p,P){this.updateInputWithDefault(C.ID.SHIP_INPUT,"");this.updateNetWeightRelated(p.NetWeight,p.WeightUoM);this.clearGrossWeight();},o,"update weight chart, color and text").then(function(p,P){this.oItemHelper.clear();G.setUnpackEnable(false);},o,"remove product from right table").then(function(){b.updateShipHUConsGroup(G.getCurrentShipHandlingUnit(),"");this.updateScaleWeight("");},o,"clear ship side").then(function(p,P){return this.handleUnpackAllItemsWithDifferentODO(P.aProducts);},o,"if source is ODO, ship items with different odo will be unpack to bin").then(function(p,P){return S.getHUItems(G.getSourceId());},o).then(function(p,P){this.setBusy(false);this.oItemHelper.setItems(p);this.oItemHelper.sortItemsByKey(p[0].StockItemUUID,p[0].Huident);},s,"add item to the left table").then(function(){this.oItemHelper.setItemsStatusByConsGrp();G.setExceptionEnable(false);G.setProductId("");},s,"update first item and buttons status").then(function(){this.unbindProductInfo();this.bindODOInfo();},s,"update odo and product info").then(function(){this.focus(C.ID.PRODUCT_INPUT);},s).then(function(p,P){this.clearPackingInstr();},o,"clear packing info").then(function(p,P){this.updateCacheIsEmptyHU();},o,"update cache").then(function(){this.handlePackAllEnable();},s,"handle packall enable").then(function(p,m){this.delayCalledAdjustContainerHeight();},o);w.errors().default(function(e,p,m,c){if(c){this.showErrorMessagePopup(e);}},s).always(function(){this.setBusy(false);this.playAudio(C.ERROR);},o);return w;};});
