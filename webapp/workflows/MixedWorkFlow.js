/*
 * Copyright (C) 2009-2023 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["scm/ewm/packoutbdlvs1/workflows/WorkFlow","scm/ewm/packoutbdlvs1/modelHelper/Global"],function(W,G){"use strict";var _=null;var a=false;function M(){this.asyncPromise=null;W.apply(this,arguments);this._aFnServiceSuccessCallback=[];}M.reset=function(){G.resetPendingTaskNumber();_=null;a=false;};M.decreaseCounter=function(){var n=G.decreasePendingTaskNumber();var O;var f;if(n===0&&_){O=_;f=a;M.reset();if(f){O.reject();}else{O.resolve();}}};M.setObserver=function(r,b){if(_!==null){jQuery.sap.log.warning("there is alread a observerble object");_=null;}a=false;if(G.getPendingTaskNumber()>0){_={resolve:r,reject:b};}else{r();}};M.prototype=Object.create(W.prototype);M.prototype.constructor=M;M.prototype.service=function(h,c){var s=this;if(G.getAsyncMode()){this.then(function(r,S){s.asyncPromise=new Promise(function(b,d){var e=h.apply(c,[r,S]);if(e){G.increasePendingTaskNumber();s._aFnServiceSuccessCallback.forEach(function(C){e=e.then(function(p){return C(p,S);});});e=e.then(function(){M.decreaseCounter();b();});e.catch(function(E){a=true;M.decreaseCounter();s._oErrorHandler.catch(E,S);d(E);});}else{b();}});},c);}else{this.then(h,c);}return this;};M.prototype.getAsyncPromise=function(){return this.asyncPromise;};M.prototype.serviceCallback=function(h,c){this._aFnServiceSuccessCallback.push(h.bind(c));return this;};M.prototype.asyncOnly=function(h,c){if(G.getAsyncMode()){this.then(h,c);}return this;};M.prototype.syncOnly=function(h,c){if(!G.getAsyncMode()){this.then(h,c);}return this;};return M;});
